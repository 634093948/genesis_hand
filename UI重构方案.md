# 🎨 UI 重构方案

## 📋 目标

1. **优化图生视频板块** - 合并相似设置，减少重复
2. **统一视频生成** - 将文生视频和图生视频合并为一个"视频生成"板块
3. **预留图像生成板块** - 为未来的图像生成功能预留独立板块

---

## 🎯 新的 UI 结构

### 主界面布局

```
WanVideo Genesis - 万视频生成系统
│
├── 📹 视频生成 (Video Generation)
│   ├── 生成模式选择
│   │   ├── 文生视频 (Text to Video)
│   │   ├── 图生视频 - InfiniteTalk
│   │   ├── 图生视频 - WanAnimate
│   │   └── 图生视频 - Standard I2V
│   │
│   ├── 基础输入
│   │   ├── 输入图片 (仅图生视频模式显示)
│   │   ├── 正向提示词
│   │   └── 负向提示词
│   │
│   ├── 视频参数
│   │   ├── 宽度 / 高度
│   │   ├── 帧数 / FPS
│   │   └── 🔒 锁定宽高比
│   │
│   ├── 图片处理 (仅图生视频模式显示)
│   │   ├── 适配方式 (crop/pad/stretch)
│   │   ├── 裁剪位置
│   │   └── 缩放算法
│   │
│   ├── 生成参数
│   │   ├── Steps / CFG / Shift
│   │   ├── Seed / Scheduler
│   │   └── Denoise
│   │
│   ├── 模型配置
│   │   ├── Diffusion Model
│   │   ├── VAE Model
│   │   └── T5 Encoder
│   │
│   ├── 高级设置 (折叠)
│   │   ├── 基础精度
│   │   ├── 量化
│   │   └── 注意力模式
│   │
│   ├── 模式特定设置 (动态显示)
│   │   ├── InfiniteTalk 设置
│   │   │   ├── 音频文件
│   │   │   ├── 窗口参数
│   │   │   └── Wav2Vec 设置
│   │   │
│   │   └── WanAnimate 设置
│   │       ├── 姿态图片
│   │       ├── 面部图片
│   │       └── 强度设置
│   │
│   └── 🎬 生成按钮
│
├── 🖼️ 图像生成 (Image Generation) ← 新增板块
│   ├── 生成模式选择
│   │   ├── 文生图 (Text to Image)
│   │   └── 图生图 (Image to Image)
│   │
│   ├── 基础输入
│   │   ├── 输入图片 (仅图生图模式)
│   │   ├── 正向提示词
│   │   └── 负向提示词
│   │
│   ├── 图像参数
│   │   ├── 宽度 / 高度
│   │   └── 批次大小
│   │
│   ├── 生成参数
│   │   ├── Steps / CFG
│   │   └── Seed / Scheduler
│   │
│   ├── 模型配置
│   │   ├── Diffusion Model
│   │   ├── VAE Model
│   │   └── T5 Encoder
│   │
│   └── 🎨 生成按钮
│
└── ⚙️ 模型设置 (Model Settings)
    ├── 模型路径配置
    ├── 模型管理
    └── 系统设置
```

---

## 🔄 优化内容

### 1. 合并视频生成模式

**原来**:
- 文生视频 (独立标签页)
- 图生视频 (独立标签页)

**优化后**:
- 视频生成 (统一标签页)
  - 模式选择: 文生视频 / InfiniteTalk / WanAnimate / Standard I2V

### 2. 动态显示相关设置

**根据模式动态显示**:
- 文生视频: 隐藏图片输入、图片处理
- 图生视频: 显示图片输入、图片处理
- InfiniteTalk: 显示音频、窗口参数
- WanAnimate: 显示姿态、面部设置

### 3. 共通参数集中管理

**共通参数** (所有模式都需要):
- 提示词
- 视频尺寸
- 生成参数
- 模型选择
- 高级设置

**模式特定参数** (按需显示):
- 图片输入 (图生视频)
- 图片处理 (图生视频)
- 音频文件 (InfiniteTalk)
- 姿态/面部 (WanAnimate)

---

## 📐 布局设计

### 左右分栏布局

```
┌─────────────────────────────────────────────────────────────┐
│  📹 视频生成                                                 │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌────────────────────────┐  ┌────────────────────────────┐ │
│  │  左侧 - 输入和参数      │  │  右侧 - 输出和预览          │ │
│  │                        │  │                            │ │
│  │  • 模式选择            │  │  • 生成的视频              │ │
│  │  • 输入图片            │  │  • 帧预览                  │ │
│  │  • 提示词              │  │  • 元数据                  │ │
│  │  • 视频参数            │  │                            │ │
│  │  • 图片处理            │  │                            │ │
│  │  • 生成参数            │  │                            │ │
│  │  • 模型配置            │  │                            │ │
│  │  • 高级设置            │  │                            │ │
│  │  • 模式特定设置        │  │                            │ │
│  │                        │  │                            │ │
│  │  🎬 生成按钮           │  │                            │ │
│  └────────────────────────┘  └────────────────────────────┘ │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## 🎨 UI 组件优化

### 1. 使用 Accordion 折叠面板

**折叠的设置** (减少视觉混乱):
- ✅ 高级设置 (默认折叠)
- ✅ 模式特定设置 (默认展开)
- ✅ 图片处理 (默认展开)

**始终展开的设置** (常用):
- ✅ 模式选择
- ✅ 输入图片
- ✅ 提示词
- ✅ 视频参数
- ✅ 生成参数

### 2. 使用 Group 分组

**视觉分组**:
- 基础输入组
- 视频参数组
- 图片处理组
- 生成参数组
- 模型配置组

### 3. 使用 Row 横向排列

**节省空间**:
- 宽度 / 高度 (横向)
- 帧数 / FPS (横向)
- Steps / CFG / Shift (横向)
- 裁剪位置 / 缩放算法 (横向)

---

## 🔧 实现步骤

### 步骤 1: 创建统一的视频生成标签页
- [ ] 合并文生视频和图生视频
- [ ] 添加模式选择 Radio
- [ ] 实现动态显示逻辑

### 步骤 2: 优化参数布局
- [ ] 使用 Accordion 折叠不常用设置
- [ ] 使用 Group 分组相关参数
- [ ] 使用 Row 横向排列参数

### 步骤 3: 实现动态显示
- [ ] 根据模式显示/隐藏图片输入
- [ ] 根据模式显示/隐藏图片处理
- [ ] 根据模式显示/隐藏特定设置

### 步骤 4: 添加图像生成板块
- [ ] 创建新的标签页
- [ ] 添加基础 UI 组件
- [ ] 预留功能接口

### 步骤 5: 测试和优化
- [ ] 测试所有模式切换
- [ ] 测试参数传递
- [ ] 优化用户体验

---

## 📊 参数映射

### 模式映射

| UI 选择 | 内部模式值 | 说明 |
|---------|-----------|------|
| 文生视频 | "Text to Video" | 原文生视频 |
| InfiniteTalk | "InfiniteTalk" | 音频驱动 |
| WanAnimate | "WanAnimate" | 姿态/面部驱动 |
| Standard I2V | "Standard I2V" | 标准图生视频 |

### 动态显示规则

| 组件 | 文生视频 | InfiniteTalk | WanAnimate | Standard I2V |
|------|---------|-------------|-----------|-------------|
| 输入图片 | ❌ | ✅ | ✅ | ✅ |
| 图片处理 | ❌ | ✅ | ✅ | ✅ |
| 音频文件 | ❌ | ✅ | ❌ | ❌ |
| 窗口参数 | ❌ | ✅ | ❌ | ❌ |
| Wav2Vec | ❌ | ✅ | ❌ | ❌ |
| 姿态图片 | ❌ | ❌ | ✅ | ❌ |
| 面部图片 | ❌ | ❌ | ✅ | ❌ |

---

## 🎯 优势

### 1. 用户体验提升
- ✅ 所有视频生成功能在一个地方
- ✅ 减少标签页切换
- ✅ 更清晰的功能分类

### 2. 界面更简洁
- ✅ 折叠不常用设置
- ✅ 动态显示相关参数
- ✅ 减少视觉混乱

### 3. 易于扩展
- ✅ 添加新模式很容易
- ✅ 图像生成独立板块
- ✅ 模块化设计

### 4. 参数复用
- ✅ 共通参数只定义一次
- ✅ 减少代码重复
- ✅ 易于维护

---

## 📝 注意事项

### 1. 保持向后兼容
- ✅ 参数名称不变
- ✅ 参数数量不变
- ✅ 函数接口不变

### 2. 测试充分
- ✅ 测试所有模式
- ✅ 测试参数传递
- ✅ 测试动态显示

### 3. 文档更新
- ✅ 更新使用说明
- ✅ 更新参数说明
- ✅ 更新截图

---

## 🚀 开始实施

准备好后，我将按照以下顺序实施:

1. **创建备份** ✅ (已完成)
2. **重构视频生成标签页**
3. **实现动态显示逻辑**
4. **添加图像生成板块**
5. **测试和优化**

**是否开始实施？** 🎨
