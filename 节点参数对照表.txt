========================================
  WanVideo èŠ‚ç‚¹å‚æ•°å¯¹ç…§è¡¨
  æ‰€æœ‰åŠ è½½å™¨çš„æ­£ç¡®å‚æ•°å
========================================

## ğŸ“‹ æ¨¡å‹åŠ è½½å™¨å‚æ•°

### 1. WanVideoModelLoader

**å‡½æ•°ç­¾å:**
```python
def loadmodel(self, 
    model,              # âœ… æ¨¡å‹æ–‡ä»¶å
    base_precision,     # âœ… åŸºç¡€ç²¾åº¦
    load_device,        # âœ… åŠ è½½è®¾å¤‡
    quantization,       # âœ… é‡åŒ–æ–¹å¼
    compile_args=None,
    attention_mode="sdpa",
    block_swap_args=None,
    lora=None,
    ...
)
```

**æ­£ç¡®è°ƒç”¨:**
```python
model_loader = NODE_CLASS_MAPPINGS['WanVideoModelLoader']()
result = model_loader.loadmodel(
    model="Wan2_1-InfiniteTalk-Single_fp16.safetensors",  # âœ… model
    base_precision="bf16",
    quantization="disabled",
    load_device="offload_device",
    attention_mode="sdpa"
)
```

**âŒ å¸¸è§é”™è¯¯:**
```python
# âŒ é”™è¯¯: ä½¿ç”¨ model_name
result = model_loader.loadmodel(model_name="xxx")  # TypeError!
```

---

### 2. WanVideoVAELoader

**å‡½æ•°ç­¾å:**
```python
def loadmodel(self, 
    model_name,         # âœ… VAE æ¨¡å‹æ–‡ä»¶å
    precision,          # âœ… ç²¾åº¦
    compile_args=None
)
```

**æ­£ç¡®è°ƒç”¨:**
```python
vae_loader = NODE_CLASS_MAPPINGS['WanVideoVAELoader']()
result = vae_loader.loadmodel(
    model_name="wan_vae.safetensors",  # âœ… model_name
    precision="bf16"
)
```

**âŒ å¸¸è§é”™è¯¯:**
```python
# âŒ é”™è¯¯: ä½¿ç”¨ vae_name
result = vae_loader.loadmodel(vae_name="xxx")  # TypeError!
```

---

### 3. LoadWanVideoT5TextEncoder

**å‡½æ•°ç­¾å:**
```python
def loadmodel(self, 
    model_name,         # âœ… T5 æ¨¡å‹æ–‡ä»¶å
    precision,          # âœ… ç²¾åº¦
    load_device="offload_device",
    quantization="disabled"
)
```

**æ­£ç¡®è°ƒç”¨:**
```python
t5_loader = NODE_CLASS_MAPPINGS['LoadWanVideoT5TextEncoder']()
result = t5_loader.loadmodel(
    model_name="google_t5-v1_1-xxl",  # âœ… model_name
    precision="bf16",
    load_device="offload_device"
)
```

**âŒ å¸¸è§é”™è¯¯:**
```python
# âŒ é”™è¯¯: ä½¿ç”¨ t5_model
result = t5_loader.loadmodel(t5_model="xxx")  # TypeError!
```

---

## ğŸ“Š å‚æ•°åæ€»ç»“

| èŠ‚ç‚¹ | å‚æ•°å | è¯´æ˜ |
|------|--------|------|
| WanVideoModelLoader | `model` | âš ï¸ æ³¨æ„ä¸æ˜¯ model_name |
| WanVideoVAELoader | `model_name` | âœ… ä½¿ç”¨ model_name |
| LoadWanVideoT5TextEncoder | `model_name` | âœ… ä½¿ç”¨ model_name |

## ğŸ¯ è®°å¿†æŠ€å·§

**WanVideoModelLoader æ¯”è¾ƒç‰¹æ®Š:**
- å…¶ä»–åŠ è½½å™¨éƒ½ç”¨ `model_name`
- åªæœ‰ WanVideoModelLoader ç”¨ `model` (æ²¡æœ‰ _name åç¼€)

**ä¸ºä»€ä¹ˆä¸ä¸€è‡´?**
- å› ä¸º WanVideoModelLoader æœ‰å¾ˆå¤šå¯é€‰å‚æ•°
- ä½¿ç”¨ç®€çŸ­çš„ `model` æ›´ç®€æ´
- å…¶ä»–åŠ è½½å™¨å‚æ•°è¾ƒå°‘,ä½¿ç”¨ `model_name` æ›´æ˜ç¡®

---

## âœ… å®Œæ•´ç¤ºä¾‹

```python
# åŠ è½½æ‰€æœ‰æ¨¡å‹çš„æ­£ç¡®æ–¹å¼
def load_all_models(model_name, vae_name, t5_name):
    # 1. åŠ è½½ Diffusion Model
    model_loader = NODE_CLASS_MAPPINGS['WanVideoModelLoader']()
    model_result = model_loader.loadmodel(
        model=model_name,  # âš ï¸ æ³¨æ„: model (ä¸æ˜¯ model_name)
        base_precision="bf16",
        quantization="disabled",
        load_device="offload_device",
        attention_mode="sdpa"
    )
    model = model_result[0]
    
    # 2. åŠ è½½ VAE
    vae_loader = NODE_CLASS_MAPPINGS['WanVideoVAELoader']()
    vae_result = vae_loader.loadmodel(
        model_name=vae_name,  # âœ… model_name
        precision="bf16"
    )
    vae = vae_result[0]
    
    # 3. åŠ è½½ T5
    t5_loader = NODE_CLASS_MAPPINGS['LoadWanVideoT5TextEncoder']()
    t5_result = t5_loader.loadmodel(
        model_name=t5_name,  # âœ… model_name
        precision="bf16",
        load_device="offload_device"
    )
    t5 = t5_result[0]
    
    return model, vae, t5
```

---

## ğŸ” å¦‚ä½•æŸ¥æ‰¾æ­£ç¡®å‚æ•°

### æ–¹æ³• 1: æŸ¥çœ‹èŠ‚ç‚¹å®šä¹‰
```python
# æŸ¥çœ‹ INPUT_TYPES
class WanVideoModelLoader:
    @classmethod
    def INPUT_TYPES(s):
        return {
            "required": {
                "model": (...),  # â† è¿™é‡Œæ˜¯å‚æ•°å
                ...
            }
        }
    
    def loadmodel(self, model, ...):  # â† å‡½æ•°ç­¾å
        ...
```

### æ–¹æ³• 2: æŸ¥çœ‹ FUNCTION å®šä¹‰
```python
FUNCTION = "loadmodel"  # å‡½æ•°å

def loadmodel(self, model, base_precision, ...):
    # ç¬¬ä¸€ä¸ªå‚æ•°(selfé™¤å¤–)å°±æ˜¯ä¸»è¦å‚æ•°
    ...
```

---

## ğŸ“ ä¿®å¤è®°å½•

**æ–‡ä»¶:** `wanvideo_gradio_app.py`
**ä½ç½®:** ç¬¬ 220-245 è¡Œ

**ä¿®å¤å†…å®¹:**
1. âœ… WanVideoModelLoader: `model_name` â†’ `model`
2. âœ… WanVideoVAELoader: `vae_name` â†’ `model_name`
3. âœ… LoadWanVideoT5TextEncoder: `t5_model` â†’ `model_name`

---

## ğŸ‰ ç°åœ¨åº”è¯¥èƒ½æ­£å¸¸å·¥ä½œäº†!

æ‰€æœ‰å‚æ•°åéƒ½å·²ä¿®å¤,æ¨¡å‹åŠ è½½åº”è¯¥ä¸ä¼šå†æŠ¥é”™ã€‚

========================================
